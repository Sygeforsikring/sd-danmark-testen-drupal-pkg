(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{103:function(e,t,s){e.exports=s(202)},161:function(e,t){},163:function(e,t){},179:function(e,t,s){},202:function(e,t,s){"use strict";s.r(t);s(104),s(133);var n=s(0),a=s.n(n),r=s(38),o=s.n(r),i=s(28),c=s(39),u=s(40),l=s(42),p=s(41),h=s(43),g=s(3),f=s(65),m=s(19),d=s.n(m),v=(s(179),s(102)),w=s(66),E={given_answers:[],step:0,history:[]},b={given_answers:[],step:1},j=function(e,t){var s=e.calcScore(t.given_answers),n=Object(i.a)({},t,{score:s});if(e.isDebugging()){for(var a in console.group("historyRecord"),n)console.log(a,n[a]);console.groupEnd("historyRecord")}e.setState({history:Object(w.a)(e.state.history).concat([n])})},_=function(e){var t=Object(w.a)(e.state.history);t.pop();var s=(t=t.length?t:b)[t.length-1];if(e.isDebugging()){for(var n in console.group("historyGoBack"),s)console.log(n,s[n]);console.groupEnd("historyGoBack")}s.score;var a=Object(v.a)(s,["score"]);e.setState(Object(i.a)({},{history:t},a))},y=function(e){return"/api/".concat(e)},k=function(e){function t(e){var s;Object(c.a)(this,t),(s=Object(l.a)(this,Object(p.a)(t).call(this,e))).handleChange=function(e){s.setState({age:parseInt(e.target.value),showMessage:!1})},s.handleNext=function(e){var t=s.state.age;if(t<16)s.setState({showMessage:!0});else{var n=s.state.intervals.find(function(e){return t>=e.from&&t<=e.to});s.props.nextStep(n.id,s.state.answer_ids)}};var n=[];e.answers.forEach(function(e){var t=e.text.split("-");n.push({from:t[0],to:t[1],id:e.answer_id})});var a=e.answers.map(function(e){return e.answer_id});return s.state={age:"",intervals:n,answer_ids:a,showMessage:!1},s}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.state.showMessage?"next disabled":"next";return a.a.createElement("div",{className:"age-step"},a.a.createElement("label",{htmlFor:"age"},"Indtast alder:"),a.a.createElement("input",{name:"age",type:"number",value:this.state.age,onChange:this.handleChange}),a.a.createElement("button",{className:e,onClick:this.handleNext},"N\xe6ste"),this.state.showMessage&&this.props.message&&a.a.createElement("div",{className:"message"},d()(this.props.message)))}}]),t}(n.Component),O=s(183),S=function(e){return a.a.createElement(f.Transition,Object.assign({in:!0,exit:!0},e,{timeout:900}),function(t){var s="transition ".concat(t);return a.a.createElement("div",{className:s},e.children)})};function N(e){return a.a.createElement(S,e,a.a.createElement("p",null,"Henter data..."))}function q(e){return a.a.createElement(S,e,a.a.createElement("div",{className:"test-wrapper--intro"},d()(e.intro),a.a.createElement("button",{onClick:e.start},"Start testen")))}function x(e){var t=e.step,s=e.info,n=e.onClick,r=e.answered,o=s.answers.map(function(e){return e.answer_id});return a.a.createElement("div",{className:"test-wrapper--step"},a.a.createElement("h2",null,s.question),s.text&&s.text.map(function(e,t){return a.a.createElement("p",{key:t},e)}),1===t&&a.a.createElement(k,{answers:s.answers,nextStep:n,message:s.message}),t>1&&s.answers&&s.answers.map(function(e){var t;return r.includes(e.answer_id)&&(t="active"),a.a.createElement("div",{key:e.answer_id},a.a.createElement("button",{className:t,onClick:n.bind(null,e.answer_id,o)},e.text))}),s.extra&&d()(s.extra))}function C(e){var t=e.step,s=e.question,n=e.given_answers,r=e.recordAnswerAndStep;return a.a.createElement(S,e,a.a.createElement("div",{className:"Question"},a.a.createElement(x,{step:t,info:s,onClick:function(e,t){r(e,t)},answered:n})))}function A(e){var t=e.result,s="result result__group--".concat(t.group);return a.a.createElement(S,e,a.a.createElement("div",{className:"test-wrapper--result"},a.a.createElement("div",{className:s},d()(t.html))))}function B(e){for(var t=[],s=0;s<e.count;++s)t[s]="";for(var n=0;n<e.step-1;++n)t[n]+="seen ";return t[e.step-1]+="active ",t[e.count-1]+="final ",a.a.createElement("ul",{className:"test-wrapper--status"},t.map(function(e,t){return a.a.createElement("li",{key:t,className:e},a.a.createElement("i",null))}))}var M=function(e){function t(e){var s;return Object(c.a)(this,t),(s=Object(l.a)(this,Object(p.a)(t).call(this,e))).startTest=function(){s.setState(function(){return{step:1}}),j(Object(g.a)(Object(g.a)(s)),b)},s.recordAnswerAndStep=function(e,t){var n=s.state.given_answers.filter(function(e){return!t.includes(e)});n.push(e);var a={given_answers:n};if(s.calcScore(n)<0)return a.step=s.state.count,j(Object(g.a)(Object(g.a)(s)),{step:a.step,given_answers:a.given_answers}),void s.setState(a);var r=0,o=s.state.step+1;for(o>=s.state.count&&(r=s.state.count);!r&&o<s.state.count;){var i=s.state.json.questions[o-1],c=i.depends||[];c.length?function(){var e=0;c.forEach(function(t){n.forEach(function(s){t===s&&++e})}),0<e&&(i.operator&&"or"===i.operator&&(r=o),e===c.length&&(r=o))}():r=o,o++}(!r||r>=s.state.count)&&(r=s.state.count),a.step=r,j(Object(g.a)(Object(g.a)(s)),{step:a.step,given_answers:a.given_answers}),s.setState(a)},s.findScores=function(e,t,s){for(var n=0;n<t.length;++n){var a=t[n];e[a.answer_id]=Array.isArray(a.score)?a.score[s]:a.score}return e},s.calcScore=function(e){if(!s.state.json)return 0;for(var t=e||s.state.given_answers,n=s.state.json.questions,a=[],r=t[0]||0,o=0;o<n.length;++o){var i=n[o];s.findScores(a,i.answers,r),i.sub&&i.sub.forEach(function(e){s.findScores(a,e.answers,r)})}return t.reduce(function(e,t){return e+a[t]},0)},s.getResult=function(){for(var e=s.calcScore(),t=s.state.json.results,n=0;n<t.length;++n){var a=t[n];if(a.up_to&&e<a.up_to||a.in&&a.in.includes(e)||!a.in&&!a.up_to)return a}return{}},s.goBack=function(){return _(Object(g.a)(Object(g.a)(s)))},s.isDebugging=function(){return!0},e.json?s.state=Object(i.a)({},E,{steps:e.json.questions[e.json.questions.length-1].step+1,count:e.json.questions.length+1,json:e.json}):(s.state=E,O.get(y(s.props.quiz)).then(function(e){var t=e.data;s.setState(function(){return{steps:t.questions[t.questions.length-1].step+1,count:t.questions.length+1,json:t}})}).catch(function(e){console.warn&&console.warn(e)})),s}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=0;return this.state.step&&(e=this.state.step>=this.state.count?this.state.steps:this.state.json.questions[this.state.step-1].step),this.isDebugging()&&(console.group("Current state"),console.log("History",this.state.history),console.log("Current score",this.calcScore()),console.log("State",this.state),console.groupEnd("Current state")),a.a.createElement("div",{className:"test-wrapper"},1<this.state.step&&a.a.createElement("a",{href:!0,className:"back-button",onClick:this.goBack},"Tilbage"),a.a.createElement("div",{className:"test-wrapper-body"},a.a.createElement(f.TransitionGroup,null,0===this.state.step&&!this.state.json&&a.a.createElement(N,{key:"loading"}),0===this.state.step&&this.state.json&&a.a.createElement(q,{key:"testintro",intro:this.state.json.intro,start:this.startTest}),0<this.state.step&&this.state.step>=this.state.count&&a.a.createElement(A,{key:"result",result:this.getResult()}),0<this.state.step&&this.state.step<this.state.count&&a.a.createElement(C,{step:this.state.step,key:"question"+this.state.step,question:this.state.json.questions[this.state.step-1],given_answers:this.state.given_answers,recordAnswerAndStep:this.recordAnswerAndStep}),0<this.state.step&&a.a.createElement(B,{key:"status",step:e,count:this.state.steps}))))}}]),t}(n.Component);o.a.render(a.a.createElement(M,{quiz:"danmark-testen"}),document.getElementById("danmark-testen"))}},[[103,2,1]]]);
//# sourceMappingURL=main.fa172f10.chunk.js.map